<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeatherSphere Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #00feba, #5b548a);
            --secondary-gradient: linear-gradient(135deg, #ff7e5f, #feb47b);
            --card-bg: rgba(255, 255, 255, 0.15);
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --highlight: #ffd700;
            --danger: #ff4757;
            --success: #2ed573;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            --border-radius: 20px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --sunny: linear-gradient(135deg, #f6d365, #fda085);
            --rainy: linear-gradient(135deg, #4b6cb7, #182848);
            --cloudy: linear-gradient(135deg, #bdc3c7, #2c3e50);
            --clear: linear-gradient(135deg, #56ccf2, #2f80ed);
            --thunderstorm: linear-gradient(135deg, #0f0c29, #302b63);
            --snow: linear-gradient(135deg, #e6dada, #274046);
            --mist: linear-gradient(135deg, #606c88, #3f4c6b);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: var(--primary-gradient) no-repeat fixed;
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
            transition: background 0.5s ease;
        }

        body.sunny {
            background: var(--sunny);
        }

        body.rainy {
            background: var(--rainy);
        }

        body.cloudy {
            background: var(--cloudy);
        }

        body.clear {
            background: var(--clear);
        }

        body.thunderstorm {
            background: var(--thunderstorm);
        }

        body.snow {
            background: var(--snow);
        }

        body.mist {
            background: var(--mist);
        }

        .container {
            width: 95%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 0;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
            animation: fadeInDown 0.8s ease-out;
        }

        .header h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 600;
            background: linear-gradient(to right, #ffffff, #e0e0e0);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .search-container {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
            position: relative;
            animation: fadeIn 1s ease-out;
        }

        .search-box {
            position: relative;
            width: 100%;
            max-width: 600px;
        }

        .search-box input {
            width: 100%;
            padding: 1rem 1.5rem;
            border-radius: 50px;
            border: none;
            outline: none;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: var(--text-primary);
            font-size: 1.1rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            padding-right: 4rem;
        }

        .search-box input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-box input:focus {
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .search-box button {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 3.5rem;
            border-radius: 50%;
            border: none;
            background: var(--secondary-gradient);
            color: white;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .search-box button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .search-box button i {
            font-size: 1.2rem;
        }

        .weather-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .current-weather {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: fadeInUp 0.8s ease-out;
        }

        .current-weather:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }

        .location {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .location h2 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .location p {
            font-size: 1rem;
            opacity: 0.8;
        }

        .weather-icon {
            width: 120px;
            height: 120px;
            margin: 1rem 0;
            filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.2));
            animation: pulse 2s infinite alternate;
        }

        .temperature {
            font-size: 3.5rem;
            font-weight: 300;
            margin: 0.5rem 0;
            position: relative;
        }

        .temperature::after {
            content: "°C";
            font-size: 1.5rem;
            position: absolute;
            top: 0.5rem;
        }

        .description {
            font-size: 1.3rem;
            font-style: italic;
            margin-bottom: 1rem;
            text-transform: capitalize;
        }

        .temp-range {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .temp-range div {
            display: flex;
            align-items: center;
        }

        .temp-range i {
            margin-right: 0.3rem;
        }

        .weather-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            width: 100%;
        }

        .detail-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1rem;
            display: flex;
            align-items: center;
            transition: var(--transition);
        }

        .detail-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }

        .detail-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
            color: var(--highlight);
        }

        .detail-text {
            display: flex;
            flex-direction: column;
        }

        .detail-value {
            font-size: 1.2rem;
            font-weight: 500;
        }

        .detail-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .forecast-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            animation: fadeInUp 1s ease-out;
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 0.5rem;
        }

        .section-title::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background: var(--highlight);
            border-radius: 3px;
        }

        .forecast-days {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .forecast-day {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            transition: var(--transition);
            cursor: pointer;
            text-align: center;
        }

        .forecast-day:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .forecast-day.active {
            background: rgba(255, 255, 255, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .day-name {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .day-date {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 1rem;
        }

        .forecast-icon {
            width: 70px;
            height: 70px;
            margin: 0.5rem auto;
            filter: drop-shadow(0 3px 5px rgba(0, 0, 0, 0.2));
        }

        .forecast-temp {
            font-size: 1.5rem;
            font-weight: 500;
            margin: 0.5rem 0;
        }

        .forecast-description {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
            text-transform: capitalize;
        }

        .forecast-details {
            display: flex;
            justify-content: space-around;
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .hourly-forecast {
            margin-top: 2rem;
        }

        .hourly-container {
            display: flex;
            overflow-x: auto;
            gap: 1rem;
            padding-bottom: 1rem;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
        }

        .hourly-container::-webkit-scrollbar {
            height: 6px;
        }

        .hourly-container::-webkit-scrollbar-thumb {
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        .hourly-item {
            min-width: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: var(--transition);
        }

        .hourly-item:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .hour-time {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .hour-icon {
            width: 40px;
            height: 40px;
            margin: 0.5rem 0;
        }

        .hour-temp {
            font-size: 1.2rem;
            font-weight: 500;
        }

        .comparison-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            animation: fadeInUp 1.2s ease-out;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .comparison-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            transition: var(--transition);
        }

        .comparison-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }

        .comparison-date {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .comparison-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-bottom: 0.3rem;
        }

        .stat-value {
            font-size: 1.1rem;
            font-weight: 500;
        }

        .temp-meter {
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            margin-top: 0.5rem;
            overflow: hidden;
        }

        .temp-fill {
            height: 100%;
            border-radius: 4px;
            background: var(--secondary-gradient);
        }

        .footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 1.5s ease-out;
        }

        .footer p {
            opacity: 0.8;
            font-size: 0.9rem;
        }

        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .loading.active {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--highlight);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            color: white;
            font-size: 1.2rem;
            margin-top: 1rem;
        }

        .error-message {
            display: none;
            background: rgba(255, 71, 87, 0.2);
            border: 1px solid var(--danger);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem auto;
            max-width: 600px;
            text-align: center;
            animation: fadeIn 0.3s ease-out;
        }

        .error-message.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            from {
                transform: scale(1);
            }
            to {
                transform: scale(1.1);
            }
        }

        .temperature-scale {
            display: flex;
            justify-content: center;
            margin-top: 1rem;
        }

        .scale-item {
            margin: 0 0.5rem;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            background: rgba(255, 255, 255, 0.1);
            transition: var(--transition);
            cursor: pointer;
        }

        .scale-item.active {
            background: var(--highlight);
            color: #333;
            font-weight: 500;
        }

        .air-quality {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            width: 100%;
        }

        .quality-meter {
            height: 10px;
            background: linear-gradient(to right, #2ed573, #ffd700, #ff7e5f, #ff4757);
            border-radius: 5px;
            margin-top: 0.5rem;
            position: relative;
        }

        .quality-indicator {
            position: absolute;
            top: -5px;
            width: 3px;
            height: 20px;
            background: white;
            transform: translateX(-50%);
        }

        .quality-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.7rem;
        }

        .quality-value {
            font-weight: 500;
            margin-top: 0.3rem;
        }

        .quality-status {
            font-weight: 500;
            margin-top: 0.3rem;
        }

        .quality-good {
            color: var(--success);
        }

        .quality-moderate {
            color: #ffd700;
        }

        .quality-unhealthy {
            color: #ff7e5f;
        }

        .quality-very-unhealthy {
            color: #ff4757;
        }

        .quality-hazardous {
            color: #8b0000;
        }

        .sun-moon {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 1rem;
        }

        .sun-moon-item {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 0.8rem;
            width: 48%;
        }

        .sun-moon-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
            color: var(--highlight);
        }

        .sun-moon-text {
            display: flex;
            flex-direction: column;
        }

        .sun-moon-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .sun-moon-time {
            font-size: 1rem;
            font-weight: 500;
        }

        .weather-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.2;
            background-size: cover;
            background-position: center;
            transition: opacity 0.5s ease;
        }

        .favorite-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--highlight);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .favorite-btn:hover {
            transform: scale(1.1);
        }

        .favorite-btn.active {
            color: var(--danger);
        }

        .recent-searches {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 0 0 20px 20px;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            z-index: 10;
        }

        .recent-searches.active {
            display: block;
        }

        .recent-item {
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .recent-item:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .recent-item:last-child {
            border-radius: 0 0 20px 20px;
        }

        .theme-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--secondary-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 100;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .theme-toggle i {
            font-size: 1.2rem;
        }

        .dark-mode {
            --primary-gradient: linear-gradient(135deg, #0f0c29, #302b63);
            --secondary-gradient: linear-gradient(135deg, #8e2de2, #4a00e0);
            --card-bg: rgba(0, 0, 0, 0.2);
            --highlight: #8e2de2;
        }

        @media (max-width: 768px) {
            .weather-display {
                grid-template-columns: 1fr;
            }

            .forecast-days {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .weather-details {
                grid-template-columns: 1fr;
            }

            .theme-toggle {
                bottom: 1rem;
                right: 1rem;
                width: 40px;
                height: 40px;
            }
        }

        @media (max-width: 480px) {
            .search-box input {
                padding: 0.8rem 1.2rem;
                font-size: 1rem;
            }

            .current-weather, .forecast-container, .comparison-container {
                padding: 1.5rem;
            }

            .temperature {
                font-size: 2.5rem;
            }

            .forecast-days {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>

<body class="clear">
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <div class="loading-text">Fetching weather data...</div>
    </div>

    <div class="container">
        <div class="header">
            <h1>Sugam's WeatherSphere Pro</h1>
            <p>Your comprehensive weather companion with advanced forecasting</p>
        </div>

        <div class="search-container">
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Enter city name..." spellcheck="false">
                <button id="search-btn"><i class="fas fa-search"></i></button>
                <div class="recent-searches" id="recent-searches"></div>
            </div>
        </div>

        <div class="error-message" id="error-message"></div>

        <div class="weather-display">
            <div class="current-weather">
                <button class="favorite-btn" id="favorite-btn" title="Add to favorites"><i class="far fa-heart"></i></button>
                <div class="location">
                    <h2 id="city-name">--</h2>
                    <p id="current-date">--</p>
                </div>
                <img src="https://openweathermap.org/img/wn/01d@2x.png" alt="Weather Icon" class="weather-icon" id="weather-icon">
                <div class="temperature" id="current-temp">--</div>
                <div class="description" id="weather-description">--</div>
                <div class="temp-range">
                    <div><i class="fas fa-temperature-arrow-up"></i> <span id="temp-max">--</span>°C</div>
                    <div><i class="fas fa-temperature-arrow-down"></i> <span id="temp-min">--</span>°C</div>
                </div>
                <div class="temperature-scale">
                    <div class="scale-item active" data-scale="celsius">°C</div>
                    <div class="scale-item" data-scale="fahrenheit">°F</div>
                    <div class="scale-item" data-scale="kelvin">K</div>
                </div>
                <div class="sun-moon">
                    <div class="sun-moon-item">
                        <div class="sun-moon-icon"><i class="fas fa-sun"></i></div>
                        <div class="sun-moon-text">
                            <div class="sun-moon-label">Sunrise</div>
                            <div class="sun-moon-time" id="sunrise">--:--</div>
                        </div>
                    </div>
                    <div class="sun-moon-item">
                        <div class="sun-moon-icon"><i class="fas fa-moon"></i></div>
                        <div class="sun-moon-text">
                            <div class="sun-moon-label">Sunset</div>
                            <div class="sun-moon-time" id="sunset">--:--</div>
                        </div>
                    </div>
                </div>
                <div class="weather-details">
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-tint"></i></div>
                        <div class="detail-text">
                            <div class="detail-value" id="humidity">--%</div>
                            <div class="detail-label">Humidity</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-wind"></i></div>
                        <div class="detail-text">
                            <div class="detail-value" id="wind-speed">-- km/h</div>
                            <div class="detail-label">Wind Speed</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-compress-alt"></i></div>
                        <div class="detail-text">
                            <div class="detail-value" id="pressure">-- hPa</div>
                            <div class="detail-label">Pressure</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-eye"></i></div>
                        <div class="detail-text">
                            <div class="detail-value" id="visibility">-- km</div>
                            <div class="detail-label">Visibility</div>
                        </div>
                    </div>
                </div>
                <div class="air-quality" id="air-quality-container">
                    <div class="detail-label">Air Quality Index</div>
                    <div class="quality-value" id="air-quality">--</div>
                    <div class="quality-status" id="air-quality-status">--</div>
                    <div class="quality-meter">
                        <div class="quality-indicator" id="quality-indicator"></div>
                    </div>
                    <div class="quality-labels">
                        <span>Good</span>
                        <span>Moderate</span>
                        <span>Unhealthy</span>
                        <span>Very Unhealthy</span>
                        <span>Hazardous</span>
                    </div>
                </div>
            </div>

            <div class="forecast-container">
                <h2 class="section-title">5-Day Forecast</h2>
                <div class="forecast-days" id="forecast-days">
                    <!-- Forecast days will be inserted here by JavaScript -->
                </div>
                <div class="hourly-forecast">
                    <h3 class="section-title">Hourly Forecast</h3>
                    <div class="hourly-container" id="hourly-forecast">
                        <!-- Hourly forecast will be inserted here by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <div class="comparison-container">
            <h2 class="section-title">Weather Comparison</h2>
            <div class="comparison-grid" id="comparison-grid">
                <!-- Comparison cards will be inserted here by JavaScript -->
            </div>
        </div>

        <div class="footer">
            <p>© 2025 Sugam's WeatherSphere Pro | Advanced Weather Analytics Platform</p>
        </div>
    </div>

    <div class="theme-toggle" id="theme-toggle">
        <i class="fas fa-moon"></i>
    </div>

    <script>
        // API configuration
        const api = {
            weather: {
                url: "https://api.openweathermap.org/data/2.5/weather?units=metric&q=",
                key: "9fd3e42f107014b62cb7b2bbfcbea1bd"
            },
            forecast: {
                url: "https://api.openweathermap.org/data/2.5/forecast?units=metric&q=",
                key: "9fd3e42f107014b62cb7b2bbfcbea1bd"
            },
            airQuality: {
                url: "http://api.openweathermap.org/data/2.5/air_pollution?",
                key: "9fd3e42f107014b62cb7b2bbfcbea1bd"
            }
        };

        // DOM elements
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');
        const loading = document.getElementById('loading');
        const errorMessage = document.getElementById('error-message');
        const recentSearches = document.getElementById('recent-searches');
        const favoriteBtn = document.getElementById('favorite-btn');
        const themeToggle = document.getElementById('theme-toggle');

        // Current weather elements
        const cityName = document.getElementById('city-name');
        const currentDate = document.getElementById('current-date');
        const weatherIcon = document.getElementById('weather-icon');
        const currentTemp = document.getElementById('current-temp');
        const weatherDescription = document.getElementById('weather-description');
        const tempMax = document.getElementById('temp-max');
        const tempMin = document.getElementById('temp-min');
        const humidity = document.getElementById('humidity');
        const windSpeed = document.getElementById('wind-speed');
        const pressure = document.getElementById('pressure');
        const visibility = document.getElementById('visibility');
        const sunrise = document.getElementById('sunrise');
        const sunset = document.getElementById('sunset');
        const airQualityContainer = document.getElementById('air-quality-container');
        const airQuality = document.getElementById('air-quality');
        const airQualityStatus = document.getElementById('air-quality-status');
        const qualityIndicator = document.getElementById('quality-indicator');

        // Forecast elements
        const forecastDays = document.getElementById('forecast-days');
        const hourlyForecast = document.getElementById('hourly-forecast');
        const comparisonGrid = document.getElementById('comparison-grid');

        // Temperature scale elements
        const scaleItems = document.querySelectorAll('.scale-item');
        let currentScale = 'celsius';

        // App state
        let currentCity = '';
        let favorites = JSON.parse(localStorage.getItem('weatherFavorites')) || [];
        let recentCities = JSON.parse(localStorage.getItem('weatherRecentSearches')) || [];
        let isDarkMode = localStorage.getItem('weatherDarkMode') === 'true';

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            checkWeather('London');
            setupEventListeners();
            updateRecentSearchesUI();
            updateFavoriteButton();
            applyTheme();
        });

        function setupEventListeners() {
            // Search button click event
            searchBtn.addEventListener('click', () => {
                const city = searchInput.value.trim();
                if (city) {
                    checkWeather(city);
                    searchInput.blur();
                    recentSearches.classList.remove('active');
                }
            });

            // Enter key press event
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const city = searchInput.value.trim();
                    if (city) {
                        checkWeather(city);
                        searchInput.blur();
                        recentSearches.classList.remove('active');
                    }
                }
            });

            // Temperature scale toggle
            scaleItems.forEach(item => {
                item.addEventListener('click', () => {
                    scaleItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    currentScale = item.dataset.scale;
                    updateTemperatureScale();
                });
            });

            // Search input focus/blur
            searchInput.addEventListener('focus', () => {
                if (recentCities.length > 0) {
                    recentSearches.classList.add('active');
                }
            });

            document.addEventListener('click', (e) => {
                if (!searchInput.contains(e.target) && !recentSearches.contains(e.target)) {
                    recentSearches.classList.remove('active');
                }
            });

            // Favorite button click
            favoriteBtn.addEventListener('click', toggleFavorite);

            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);
        }

        async function checkWeather(city) {
            try {
                showLoading();
                clearError();

                // Fetch current weather and forecast in parallel
                const [weatherData, forecastData] = await Promise.all([
                    fetch(`${api.weather.url}${city}&appid=${api.weather.key}`).then(res => res.json()),
                    fetch(`${api.forecast.url}${city}&appid=${api.forecast.key}`).then(res => res.json())
                ]);

                // Check for API errors
                if (weatherData.cod !== 200) {
                    throw new Error(weatherData.message || 'Failed to fetch weather data');
                }

                if (forecastData.cod !== '200') {
                    throw new Error(forecastData.message || 'Failed to fetch forecast data');
                }

                // Get coordinates for air quality API
                const { lat, lon } = weatherData.coord;
                let airQualityData = null;

                try {
                    const aqResponse = await fetch(`${api.airQuality.url}lat=${lat}&lon=${lon}&appid=${api.airQuality.key}`);
                    airQualityData = await aqResponse.json();
                } catch (error) {
                    console.warn('Failed to fetch air quality data:', error);
                }

                // Update UI with all data
                updateCurrentWeather(weatherData);
                if (airQualityData) updateAirQuality(airQualityData);
                updateForecast(forecastData);
                updateComparison(forecastData);
                updateBackground(weatherData.weather[0].main);

                // Update app state
                currentCity = city;
                addToRecentSearches(city);
                updateFavoriteButton();

                hideLoading();
            } catch (error) {
                hideLoading();
                showError(error.message || 'Failed to fetch weather data. Please try again.');
                console.error('Error fetching weather data:', error);
            }
        }

        function updateCurrentWeather(data) {
            // Update location
            cityName.textContent = `${data.name}, ${data.sys.country}`;
            
            // Update date
            const now = new Date();
            currentDate.textContent = now.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });

            // Update weather icon
            const iconCode = data.weather[0].icon;
            weatherIcon.src = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;
            weatherIcon.alt = data.weather[0].description;

            // Update temperature and description
            currentTemp.dataset.celsius = Math.round(data.main.temp);
            currentTemp.dataset.fahrenheit = Math.round((data.main.temp * 9/5) + 32);
            currentTemp.dataset.kelvin = Math.round(data.main.temp + 273.15);
            
            tempMax.dataset.celsius = Math.round(data.main.temp_max);
            tempMax.dataset.fahrenheit = Math.round((data.main.temp_max * 9/5) + 32);
            tempMax.dataset.kelvin = Math.round(data.main.temp_max + 273.15);
            
            tempMin.dataset.celsius = Math.round(data.main.temp_min);
            tempMin.dataset.fahrenheit = Math.round((data.main.temp_min * 9/5) + 32);
            tempMin.dataset.kelvin = Math.round(data.main.temp_min + 273.15);
            
            updateTemperatureScale();

            // Update weather description
            weatherDescription.textContent = data.weather[0].description;

            // Update other details
            humidity.textContent = `${data.main.humidity}%`;
            windSpeed.textContent = `${(data.wind.speed * 3.6).toFixed(1)} km/h`;
            pressure.textContent = `${data.main.pressure} hPa`;
            visibility.textContent = `${(data.visibility / 1000).toFixed(1)} km`;

            // Update sunrise/sunset times
            const sunriseTime = new Date(data.sys.sunrise * 1000);
            const sunsetTime = new Date(data.sys.sunset * 1000);
            sunrise.textContent = sunriseTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
            sunset.textContent = sunsetTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
        }

        function updateTemperatureScale() {
            const tempElements = [
                { element: currentTemp, suffix: '°' },
                { element: tempMax, suffix: '°' },
                { element: tempMin, suffix: '°' }
            ];

            tempElements.forEach(temp => {
                const value = temp.element.dataset[currentScale];
                let scaleSymbol = '';
                
                if (currentScale === 'celsius') scaleSymbol = 'C';
                else if (currentScale === 'fahrenheit') scaleSymbol = 'F';
                else if (currentScale === 'kelvin') scaleSymbol = 'K';
                
                temp.element.textContent = `${value}${temp.suffix}${scaleSymbol}`;
            });
        }

        function updateAirQuality(data) {
            const aqi = data.list[0].main.aqi;
            airQuality.textContent = `AQI: ${aqi}`;
            
            // Position indicator on the quality meter (0-100% scale for 1-5 AQI)
            const position = ((aqi - 1) / 4) * 100;
            qualityIndicator.style.left = `${position}%`;
            
            // Set status and color based on AQI
            let status = '';
            let statusClass = '';
            
            switch(aqi) {
                case 1:
                    status = 'Good';
                    statusClass = 'quality-good';
                    break;
                case 2:
                    status = 'Moderate';
                    statusClass = 'quality-moderate';
                    break;
                case 3:
                    status = 'Unhealthy for Sensitive Groups';
                    statusClass = 'quality-unhealthy';
                    break;
                case 4:
                    status = 'Unhealthy';
                    statusClass = 'quality-very-unhealthy';
                    break;
                case 5:
                    status = 'Very Unhealthy/Hazardous';
                    statusClass = 'quality-hazardous';
                    break;
                default:
                    status = 'Unknown';
            }
            
            airQualityStatus.textContent = status;
            airQualityStatus.className = `quality-status ${statusClass}`;
            
            // Show the container if it was hidden
            airQualityContainer.style.display = 'block';
        }

        function updateForecast(data) {
            // Group forecast data by day
            const dailyForecast = groupForecastByDay(data.list);
            
            // Clear previous forecast
            forecastDays.innerHTML = '';
            hourlyForecast.innerHTML = '';
            
            // Add forecast for next 5 days
            dailyForecast.slice(0, 5).forEach((day, index) => {
                const dayData = day.data[0]; // Use first entry of the day for daily forecast
                const date = new Date(dayData.dt * 1000);
                
                const dayElement = document.createElement('div');
                dayElement.className = `forecast-day ${index === 0 ? 'active' : ''}`;
                dayElement.dataset.date = date.toISOString().split('T')[0];
                
                dayElement.innerHTML = `
                    <div class="day-name">${index === 0 ? 'Today' : date.toLocaleDateString('en-US', { weekday: 'long' })}</div>
                    <div class="day-date">${date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</div>
                    <img src="https://openweathermap.org/img/wn/${dayData.weather[0].icon}@2x.png" alt="${dayData.weather[0].description}" class="forecast-icon">
                    <div class="forecast-temp">${Math.round(dayData.main.temp)}°C</div>
                    <div class="forecast-description">${dayData.weather[0].description}</div>
                    <div class="forecast-details">
                        <div><i class="fas fa-temperature-arrow-up"></i> ${Math.round(dayData.main.temp_max)}°</div>
                        <div><i class="fas fa-temperature-arrow-down"></i> ${Math.round(dayData.main.temp_min)}°</div>
                    </div>
                `;
                
                // Add click event to show hourly forecast for the day
                dayElement.addEventListener('click', () => {
                    document.querySelectorAll('.forecast-day').forEach(el => el.classList.remove('active'));
                    dayElement.classList.add('active');
                    updateHourlyForecast(day.data);
                });
                
                forecastDays.appendChild(dayElement);
                
                // Show hourly forecast for today by default
                if (index === 0) {
                    updateHourlyForecast(day.data);
                }
            });
        }

        function groupForecastByDay(forecastList) {
            const days = {};
            
            forecastList.forEach(item => {
                const date = new Date(item.dt * 1000);
                const dateString = date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'numeric', day: 'numeric' });
                
                if (!days[dateString]) {
                    days[dateString] = {
                        date: dateString,
                        data: []
                    };
                }
                
                days[dateString].data.push(item);
            });
            
            return Object.values(days);
        }

        function updateHourlyForecast(hourlyData) {
            hourlyForecast.innerHTML = '';
            
            hourlyData.forEach(item => {
                const date = new Date(item.dt * 1000);
                const timeString = date.toLocaleTimeString('en-US', { hour: 'numeric', hour12: true });
                
                const hourElement = document.createElement('div');
                hourElement.className = 'hourly-item';
                
                hourElement.innerHTML = `
                    <div class="hour-time">${timeString}</div>
                    <img src="https://openweathermap.org/img/wn/${item.weather[0].icon}.png" alt="${item.weather[0].description}" class="hour-icon">
                    <div class="hour-temp">${Math.round(item.main.temp)}°</div>
                    <div class="forecast-description">${item.weather[0].description}</div>
                `;
                
                hourlyForecast.appendChild(hourElement);
            });
        }

        function updateComparison(forecastData) {
            const dailyForecast = groupForecastByDay(forecastData.list);
            comparisonGrid.innerHTML = '';
            
            // Get yesterday's date
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayString = yesterday.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'numeric', day: 'numeric' });
            
            // Find yesterday in the forecast data (if available)
            let yesterdayData = null;
            if (dailyForecast.some(day => day.date === yesterdayString)) {
                yesterdayData = dailyForecast.find(day => day.date === yesterdayString).data[0];
            }
            
            // Get today and next two days
            const todayData = dailyForecast[0].data[0];
            const tomorrowData = dailyForecast[1]?.data[0] || null;
            const dayAfterData = dailyForecast[2]?.data[0] || null;
            
            // Create comparison cards
            if (yesterdayData) {
                comparisonGrid.appendChild(createComparisonCard(yesterdayData, 'Yesterday'));
            }
            
            comparisonGrid.appendChild(createComparisonCard(todayData, 'Today'));
            
            if (tomorrowData) {
                comparisonGrid.appendChild(createComparisonCard(tomorrowData, 'Tomorrow'));
            }
            
            if (dayAfterData) {
                comparisonGrid.appendChild(createComparisonCard(dayAfterData, 
                    new Date(dayAfterData.dt * 1000).toLocaleDateString('en-US', { weekday: 'long' })));
            }
        }

        function createComparisonCard(data, title) {
            const card = document.createElement('div');
            card.className = 'comparison-card';
            
            // Calculate temperature intensity (0-100 scale based on -20°C to 40°C range)
            const tempIntensity = Math.min(100, Math.max(0, ((data.main.temp + 20) / 60) * 100));
            
            card.innerHTML = `
                <div class="comparison-date">${title}</div>
                <div class="comparison-stats">
                    <div class="stat-item">
                        <div class="stat-label">Temperature</div>
                        <div class="stat-value">${Math.round(data.main.temp)}°C</div>
                        <div class="temp-meter">
                            <div class="temp-fill" style="width: ${tempIntensity}%"></div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Humidity</div>
                        <div class="stat-value">${data.main.humidity}%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Wind</div>
                        <div class="stat-value">${(data.wind.speed * 3.6).toFixed(1)} km/h</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Conditions</div>
                        <div class="stat-value">${data.weather[0].main}</div>
                    </div>
                </div>
            `;
            
            return card;
        }

        function updateBackground(weatherCondition) {
            // Remove all weather classes
            document.body.className = '';
            
            // Add class based on weather condition
            switch(weatherCondition.toLowerCase()) {
                case 'clear':
                    document.body.classList.add('clear');
                    break;
                case 'rain':
                case 'drizzle':
                    document.body.classList.add('rainy');
                    break;
                case 'clouds':
                    document.body.classList.add('cloudy');
                    break;
                case 'thunderstorm':
                    document.body.classList.add('thunderstorm');
                    break;
                case 'snow':
                    document.body.classList.add('snow');
                    break;
                case 'mist':
                case 'smoke':
                case 'haze':
                case 'fog':
                    document.body.classList.add('mist');
                    break;
                default:
                    document.body.classList.add('clear');
            }
            
            // Apply dark mode if enabled
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
            }
        }

        function addToRecentSearches(city) {
            // Remove if already exists
            recentCities = recentCities.filter(c => c.toLowerCase() !== city.toLowerCase());
            
            // Add to beginning
            recentCities.unshift(city);
            
            // Keep only last 5 searches
            if (recentCities.length > 5) {
                recentCities = recentCities.slice(0, 5);
            }
            
            // Save to localStorage
            localStorage.setItem('weatherRecentSearches', JSON.stringify(recentCities));
            
            // Update UI
            updateRecentSearchesUI();
        }

        function updateRecentSearchesUI() {
            recentSearches.innerHTML = '';
            
            if (recentCities.length === 0) {
                const noRecent = document.createElement('div');
                noRecent.className = 'recent-item';
                noRecent.textContent = 'No recent searches';
                recentSearches.appendChild(noRecent);
                return;
            }
            
            recentCities.forEach(city => {
                const item = document.createElement('div');
                item.className = 'recent-item';
                item.textContent = city;
                item.addEventListener('click', () => {
                    checkWeather(city);
                    searchInput.value = city;
                    recentSearches.classList.remove('active');
                });
                recentSearches.appendChild(item);
            });
        }

        function toggleFavorite() {
            if (!currentCity) return;
            
            const index = favorites.indexOf(currentCity);
            
            if (index === -1) {
                // Add to favorites
                favorites.push(currentCity);
                favoriteBtn.innerHTML = '<i class="fas fa-heart"></i>';
                favoriteBtn.classList.add('active');
            } else {
                // Remove from favorites
                favorites.splice(index, 1);
                favoriteBtn.innerHTML = '<i class="far fa-heart"></i>';
                favoriteBtn.classList.remove('active');
            }
            
            // Save to localStorage
            localStorage.setItem('weatherFavorites', JSON.stringify(favorites));
        }

        function updateFavoriteButton() {
            if (!currentCity) {
                favoriteBtn.style.display = 'none';
                return;
            }
            
            favoriteBtn.style.display = 'block';
            
            if (favorites.includes(currentCity)) {
                favoriteBtn.innerHTML = '<i class="fas fa-heart"></i>';
                favoriteBtn.classList.add('active');
            } else {
                favoriteBtn.innerHTML = '<i class="far fa-heart"></i>';
                favoriteBtn.classList.remove('active');
            }
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            localStorage.setItem('weatherDarkMode', isDarkMode);
            applyTheme();
        }

        function applyTheme() {
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                document.body.classList.remove('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
        }

        function showLoading() {
            loading.classList.add('active');
        }

        function hideLoading() {
            loading.classList.remove('active');
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.add('active');
        }

        function clearError() {
            errorMessage.classList.remove('active');
        }
    </script>
</body>

</html>
